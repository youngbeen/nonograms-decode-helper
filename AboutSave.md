
# 关于数据保存

数据保存涉及2类：1、用户主动留存数据；2、动作中间数据。

## 主动留存数据`userSave`

用户可以主动触发留存数据，数据主要包含2部分内容：即puz数据以及当前的answerMap数据。主动留存的数据最多3份，用户可以选择新建或者覆盖。

```javascript
[
  // 每份留存数据是一个完整的数组项
  {
    puz: {...},
    answerMap: [...],
    name: '用户自行命名',
    timestamp: 9991029399293
  }
]
```

在用户查看历史留存的数据时，优先解析其中的关键信息（例如时间、size、resolve rate等），方便用户查看。

## 展示柜留存数据`showBoxSave`

每次正确解决的数据，将存储于缓存中。留存的数据最多3份

```javascript
[
  // 每份留存数据是一个完整的数组项
  {
    puz: {...},
    answerMap: [...],
    name: '用户自行命名',
    timestamp: 9991029399293
  }
]

## 动作中间数据`snapshot`

中间数据是系统自行保存和使用的数据，并不是设计给用户使用的。中间数据的主要使用场景是用于回退和前进功能。

中间数据相比主动留存数据`userSave`更简单一些，主要保存answerMap完整情况即可。当需要恢复到某一个快照时，系统加载对应的answerMap数据即可。

> 中间数据应该在每次重启、读取留存数据等情况时重置掉！

```javascript
[
  // 每个数据是一个快照数组项，越新产生的数据越在之后
  {
    answerMap: [...],
    timestamp: 9991029399293
  }
]
```
